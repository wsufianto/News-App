{"ast":null,"code":"var _jsxFileName = \"/Users/wsufianto/Documents/JWD/Coding/Learn-React/react-todolist/client/src/Components/News/News.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react'; // import useFetch from '../../Helpers/useFetch';\n\nimport NewsList from '../NewsItem/NewsList';\nimport { useParams, Redirect } from 'react-router-dom';\nimport { country } from '../../Helpers/CountryCode';\nimport * as api from '../../api/index';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nrequire('dotenv').config();\n\nconst News = () => {\n  _s();\n\n  let {\n    region\n  } = useParams();\n  const validRegion = Object.keys(country).includes(region); // const url = `https://newsapi.org/v2/top-headlines?country=${region}&apiKey=${process.env.REACT_APP_API_KEY}`\n\n  const buttonLabel = /*#__PURE__*/_jsxDEV(\"svg\", {\n    className: \"w-6 h-6 text-blue-400\",\n    fill: \"currentColor\",\n    viewBox: \"0 0 20 20\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    children: /*#__PURE__*/_jsxDEV(\"path\", {\n      fillRule: \"evenodd\",\n      d: \"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z\",\n      clipRule: \"evenodd\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 19,\n    columnNumber: 5\n  }, this); // const { data, setData, isLoading, errMessage } = useFetch(url)\n\n\n  const [data, setData] = useState([]);\n  useEffect(() => {\n    const getNews = async () => {\n      try {\n        const response = await api.get.get(urlLink, {\n          cancelToken: source.token\n        });\n        setData(response.data);\n        setIsLoading(false);\n        setErrMessage('');\n      } catch (err) {\n        if (axios.isCancel(err)) {\n          console.log('fetch cancelled!');\n        } else {\n          setIsLoading(false);\n          setErrMessage(err.message);\n        }\n      }\n    };\n\n    getNews(); // console.log(\"Use Effect in use!\")\n\n    return () => {\n      // console.log(\"Cleanup\")\n      source.cancel();\n    };\n    api.fetchNews(region).then(response => {\n      console.log(\"fetching news\");\n      console.log(response.data.articles);\n      setData(prevData => response.data);\n      setIsLoading(false);\n      setErrMessage('');\n    }).catch(err => {\n      console.log(err.message);\n    });\n  }, [region]);\n  console.log(region);\n  console.log(data.articles); // const { data } = api.fetchNews(region)\n  // console.log(data)\n\n  const [user] = useState(JSON.parse(localStorage.getItem('user')));\n  const [errText, setErrText] = useState(''); // const handleSave = (id) => {\n  //   const selectedNews = data.articles.filter(item => item.title === id)\n  //   const saveNews = {\n  //     userId: user.result._id,\n  //     title: selectedNews[0].title,\n  //     description: selectedNews[0].description, \n  //     author: selectedNews[0].author || '',\n  //     url: selectedNews[0].url, \n  //     urlToImage: selectedNews[0].urlToImage, \n  //     publishedAt: selectedNews[0].publishedAt, \n  //     source: selectedNews[0].source.name\n  //   }\n  //   api.addNews(saveNews)\n  //     .then(response => {\n  //       console.log(response.data)\n  //       if(response.data.code === 409) {\n  //         setErrText(prevStatus => response.data.msg)\n  //       } else if(response.data.code === 200) {\n  //         setErrText(prevStatus => response.data.msg)\n  //       } else {\n  //         setErrText(prevStatus => \"Unknown Error\")\n  //       }\n  //     }) \n  //   const articles = data.articles.filter(item => item.title !== id)\n  //   // setData({articles})\n  // }\n\n  const handleRefresh = () => {\n    console.log(\"refreshing\");\n    setErrText(prevText => '');\n    window.location.reload(false);\n  };\n\n  if (!validRegion) {\n    return /*#__PURE__*/_jsxDEV(Redirect, {\n      to: \"/*\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 12\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container bg-blue-100 rounded-lg max-w-7xl max-h-3/4 overflow-auto text-center mx-auto my-10 bg-gray-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl py-3 px-3 text-blue-600\",\n        children: \" Latest News \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"p-2 bg-blue-500 text-white rounded-lg border-2 shadow-md\",\n        onClick: handleRefresh,\n        children: \"Refresh\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-red-600\",\n      children: errText !== '' && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: errText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(NewsList, {\n      items: data.articles,\n      title: `${country[region]} News`\n      /*handleClick={handleSave}*/\n\n      /*isLoading={isLoading} errMessage={errMessage} */\n      ,\n      label: buttonLabel,\n      style: !(user === null || user === void 0 ? void 0 : user.token) ? \"invisible\" : \"visible\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, this);\n};\n\n_s(News, \"bq+X6RNu+7tWQINLo6igIkaHDjs=\", false, function () {\n  return [useParams];\n});\n\n_c = News;\nexport default News;\n\nvar _c;\n\n$RefreshReg$(_c, \"News\");","map":{"version":3,"sources":["/Users/wsufianto/Documents/JWD/Coding/Learn-React/react-todolist/client/src/Components/News/News.js"],"names":["React","useState","useEffect","NewsList","useParams","Redirect","country","api","require","config","News","region","validRegion","Object","keys","includes","buttonLabel","data","setData","getNews","response","get","urlLink","cancelToken","source","token","setIsLoading","setErrMessage","err","axios","isCancel","console","log","message","cancel","fetchNews","then","articles","prevData","catch","user","JSON","parse","localStorage","getItem","errText","setErrText","handleRefresh","prevText","window","location","reload"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\n// import useFetch from '../../Helpers/useFetch';\nimport NewsList from '../NewsItem/NewsList'\nimport { useParams, Redirect } from 'react-router-dom'\nimport { country } from '../../Helpers/CountryCode'\nimport * as api from '../../api/index'\n\nrequire('dotenv').config();\n\nconst News = () => {\n\n  let { region } = useParams()\n\n  const validRegion = Object.keys(country).includes(region)\n\n  // const url = `https://newsapi.org/v2/top-headlines?country=${region}&apiKey=${process.env.REACT_APP_API_KEY}`\n\n  const buttonLabel = (\n    <svg\n      className=\"w-6 h-6 text-blue-400\"\n      fill=\"currentColor\"\n      viewBox=\"0 0 20 20\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n    <path\n      fillRule=\"evenodd\"\n      d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z\"\n      clipRule=\"evenodd\"\n    />\n    </svg>\n  )\n\n  // const { data, setData, isLoading, errMessage } = useFetch(url)\n\n  const [data, setData] = useState([])\n\n  useEffect(() => {\n    const getNews = async () => {\n      try {\n        const response = await api.get.get(urlLink, {\n          cancelToken: source.token\n        })\n        setData(response.data)\n        setIsLoading(false)\n        setErrMessage('')\n      } catch(err) {\n        if (axios.isCancel(err)) {\n          console.log('fetch cancelled!')\n        } else {\n          setIsLoading(false)\n          setErrMessage(err.message)\n        }\n      } \n    }\n    getNews()\n    // console.log(\"Use Effect in use!\")\n\n    return () => {\n      // console.log(\"Cleanup\")\n      source.cancel()\n    }  \n    api.fetchNews(region)\n      .then(response => { \n        console.log(\"fetching news\")\n        console.log(response.data.articles)\n        setData(prevData => response.data)\n        setIsLoading(false)\n        setErrMessage('')\n      })\n      .catch(err => {\n        console.log(err.message)\n      })\n  }, [region])\n\n  console.log(region)\n  console.log(data.articles)\n  // const { data } = api.fetchNews(region)\n  // console.log(data)\n  const [user] = useState(JSON.parse(localStorage.getItem('user')))\n  const [errText, setErrText] = useState('')\n\n  // const handleSave = (id) => {\n  //   const selectedNews = data.articles.filter(item => item.title === id)\n    \n  //   const saveNews = {\n  //     userId: user.result._id,\n  //     title: selectedNews[0].title,\n  //     description: selectedNews[0].description, \n  //     author: selectedNews[0].author || '',\n  //     url: selectedNews[0].url, \n  //     urlToImage: selectedNews[0].urlToImage, \n  //     publishedAt: selectedNews[0].publishedAt, \n  //     source: selectedNews[0].source.name\n  //   }\n    \n  //   api.addNews(saveNews)\n  //     .then(response => {\n  //       console.log(response.data)\n  //       if(response.data.code === 409) {\n  //         setErrText(prevStatus => response.data.msg)\n  //       } else if(response.data.code === 200) {\n  //         setErrText(prevStatus => response.data.msg)\n  //       } else {\n  //         setErrText(prevStatus => \"Unknown Error\")\n  //       }\n  //     }) \n\n  //   const articles = data.articles.filter(item => item.title !== id)\n  //   // setData({articles})\n  // }\n\n  const handleRefresh = () => {\n    console.log(\"refreshing\")\n    setErrText(prevText => '')\n    window.location.reload(false)\n  }\n\n  if (!validRegion) {\n    return <Redirect to=\"/*\" />\n  }  \n\n  return (\n    <div className=\"container bg-blue-100 rounded-lg max-w-7xl max-h-3/4 overflow-auto text-center mx-auto my-10 bg-gray-100\">\n      <div className=\"flex justify-center items-center\">\n        <h1 className=\"text-3xl py-3 px-3 text-blue-600\"> Latest News </h1> \n        <button className=\"p-2 bg-blue-500 text-white rounded-lg border-2 shadow-md\" onClick={handleRefresh}>Refresh</button>\n      </div>\n      <div className=\"text-red-600\">\n        { errText !== '' && <p>{errText}</p>}\n      </div>\n      <NewsList items={data.articles} title={`${country[region]} News`} /*handleClick={handleSave}*/ /*isLoading={isLoading} errMessage={errMessage} */label={buttonLabel} style={!user?.token ? \"invisible\" : \"visible\"} />\n    </div>\n    \n  )\n}\n\nexport default News"]},"metadata":{},"sourceType":"module"}