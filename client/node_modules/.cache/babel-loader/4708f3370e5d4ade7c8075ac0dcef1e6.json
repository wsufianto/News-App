{"ast":null,"code":"import _slicedToArray from\"/Users/wsufianto/Documents/JWD/Coding/Learn-React/react-todolist/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import useFetch from'../../Helpers/useFetch';import NewsList from'../NewsItem/NewsList';import{useParams,Redirect}from'react-router-dom';import{country}from'../../Helpers/CountryCode';import*as api from'../../api/index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";require('dotenv').config();var News=function News(){var _useParams=useParams(),region=_useParams.region;var validRegion=Object.keys(country).includes(region);var url=\"https://newsapi.org/v2/top-headlines?country=\".concat(region,\"&apiKey=\").concat(process.env.REACT_APP_API_KEY);var buttonLabel=/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-blue-400\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z\",clipRule:\"evenodd\"})});var _useFetch=useFetch(url),data=_useFetch.data,setData=_useFetch.setData,isLoading=_useFetch.isLoading,errMessage=_useFetch.errMessage;var _useState=useState(JSON.parse(localStorage.getItem('user'))),_useState2=_slicedToArray(_useState,1),user=_useState2[0];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),errText=_useState4[0],setErrText=_useState4[1];var handleSave=function handleSave(id){var selectedNews=data.articles.filter(function(item){return item.title===id;});var saveNews={userId:user.result._id,title:selectedNews[0].title,description:selectedNews[0].description,author:selectedNews[0].author||'',url:selectedNews[0].url,urlToImage:selectedNews[0].urlToImage,publishedAt:selectedNews[0].publishedAt,source:selectedNews[0].source.name};api.addNews(saveNews).then(function(response){console.log(response.data);if(response.data.code===409){setErrText(function(prevStatus){return response.data.msg;});}else if(response.data.code===200){setErrText(function(prevStatus){return response.data.msg;});}else{setErrText(function(prevStatus){return\"Unknown Error\";});}});var articles=data.articles.filter(function(item){return item.title!==id;});setData({articles:articles});};var handleRefresh=function handleRefresh(){console.log(\"refreshing\");setErrText(function(prevText){return'';});window.location.reload(false);};if(!validRegion){return/*#__PURE__*/_jsx(Redirect,{to:\"/*\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container bg-blue-100 rounded-lg max-w-7xl max-h-3/4 overflow-auto text-center mx-auto my-10 bg-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl py-3 px-3 text-blue-600\",children:\" Latest News \"}),/*#__PURE__*/_jsx(\"button\",{className:\"p-2 bg-blue-500 text-white rounded-lg border-2 shadow-md\",onClick:handleRefresh,children:\"Refresh\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-600\",children:errText!==''&&/*#__PURE__*/_jsx(\"p\",{children:errText})}),/*#__PURE__*/_jsx(NewsList,{items:data.articles,title:\"\".concat(country[region],\" News\"),handleClick:handleSave,isLoading:isLoading,errMessage:errMessage,label:buttonLabel,style:!(user===null||user===void 0?void 0:user.token)?\"invisible\":\"visible\"})]});};export default News;","map":{"version":3,"sources":["/Users/wsufianto/Documents/JWD/Coding/Learn-React/react-todolist/client/src/Components/News/News.js"],"names":["React","useState","useFetch","NewsList","useParams","Redirect","country","api","require","config","News","region","validRegion","Object","keys","includes","url","process","env","REACT_APP_API_KEY","buttonLabel","data","setData","isLoading","errMessage","JSON","parse","localStorage","getItem","user","errText","setErrText","handleSave","id","selectedNews","articles","filter","item","title","saveNews","userId","result","_id","description","author","urlToImage","publishedAt","source","name","addNews","then","response","console","log","code","prevStatus","msg","handleRefresh","prevText","window","location","reload","token"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport useFetch from '../../Helpers/useFetch';\nimport NewsList from '../NewsItem/NewsList'\nimport { useParams, Redirect } from 'react-router-dom'\nimport { country } from '../../Helpers/CountryCode'\nimport * as api from '../../api/index'\n\nrequire('dotenv').config();\n\nconst News = () => {\n\n  let { region } = useParams()\n\n  const validRegion = Object.keys(country).includes(region)\n\n  const url = `https://newsapi.org/v2/top-headlines?country=${region}&apiKey=${process.env.REACT_APP_API_KEY}`\n\n  const buttonLabel = (\n    <svg\n      className=\"w-6 h-6 text-blue-400\"\n      fill=\"currentColor\"\n      viewBox=\"0 0 20 20\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n    <path\n      fillRule=\"evenodd\"\n      d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z\"\n      clipRule=\"evenodd\"\n    />\n    </svg>\n  )\n\n  const { data, setData, isLoading, errMessage } = useFetch(url)\n  const [user] = useState(JSON.parse(localStorage.getItem('user')))\n  const [errText, setErrText] = useState('')\n\n  const handleSave = (id) => {\n    const selectedNews = data.articles.filter(item => item.title === id)\n    \n    const saveNews = {\n      userId: user.result._id,\n      title: selectedNews[0].title,\n      description: selectedNews[0].description, \n      author: selectedNews[0].author || '',\n      url: selectedNews[0].url, \n      urlToImage: selectedNews[0].urlToImage, \n      publishedAt: selectedNews[0].publishedAt, \n      source: selectedNews[0].source.name\n    }\n    \n    api.addNews(saveNews)\n      .then(response => {\n        console.log(response.data)\n        if(response.data.code === 409) {\n          setErrText(prevStatus => response.data.msg)\n        } else if(response.data.code === 200) {\n          setErrText(prevStatus => response.data.msg)\n        } else {\n          setErrText(prevStatus => \"Unknown Error\")\n        }\n      }) \n\n    const articles = data.articles.filter(item => item.title !== id)\n    setData({articles})\n  }\n\n  const handleRefresh = () => {\n    console.log(\"refreshing\")\n    setErrText(prevText => '')\n    window.location.reload(false)\n  }\n\n  if (!validRegion) {\n    return <Redirect to=\"/*\" />\n  }  \n\n  return (\n    <div className=\"container bg-blue-100 rounded-lg max-w-7xl max-h-3/4 overflow-auto text-center mx-auto my-10 bg-gray-100\">\n      <div className=\"flex justify-center items-center\">\n        <h1 className=\"text-3xl py-3 px-3 text-blue-600\"> Latest News </h1> \n        <button className=\"p-2 bg-blue-500 text-white rounded-lg border-2 shadow-md\" onClick={handleRefresh}>Refresh</button>\n      </div>\n      <div className=\"text-red-600\">\n        { errText !== '' && <p>{errText}</p>}\n      </div>\n      <NewsList items={data.articles} title={`${country[region]} News`} handleClick={handleSave} isLoading={isLoading} errMessage={errMessage} label={buttonLabel} style={!user?.token ? \"invisible\" : \"visible\"} />\n    </div>\n    \n  )\n}\n\nexport default News"]},"metadata":{},"sourceType":"module"}